/* Generated by Together */

package com.iss.itreasury.clientmanage.client.dao;

import java.sql.Connection;
import java.sql.PreparedStatement;
import java.sql.ResultSet;
import java.sql.SQLException;
import java.util.ArrayList;
import java.util.Collection;
import java.util.Iterator;

import com.iss.itreasury.clientmanage.client.dataentity.NatureInfo;
import com.iss.itreasury.clientmanage.client.dataentity.QueryClientInfo;
import com.iss.itreasury.clientmanage.dao.CimsBaseDao;
import com.iss.itreasury.dao.ITreasuryDAOException;
import com.iss.itreasury.loan.base.LoanDAOException;
import com.iss.itreasury.util.Constant;
import com.iss.itreasury.util.Database;

/**
 * 自然人客户基本信息DAO，对应于表Client_ NatureInfo
 */
public class NatureDAO extends CimsBaseDao {
	public NatureDAO() {
		super("Client_NatureInfo");
	}

	public NatureDAO(Connection con) {
		super("Client_NatureInfo", con);
	}

	/**
	 * 数据库查找操作 根据客户id查询自然人信息
	 * 
	 * @param id
	 * @param className
	 *            需要查找的数据库表对应的Data Entity的类名
	 * @return
	 * @throws ITreasuryDAOException
	 */
	public NatureInfo findByclietID(long clientid) throws ITreasuryDAOException {
		initDAO();
		Collection data = null;
		Iterator it = null;
		NatureInfo res = new NatureInfo();
		StringBuffer buffer = new StringBuffer();
		buffer.append("SELECT * FROM \n");
		buffer.append(strTableName);
		buffer.append("\n WHERE clientid = " + clientid);
		String strSQL = buffer.toString();
		log.debug(strSQL);

		try {

			transPS = transConn.prepareStatement(strSQL);
			transRS = transPS.executeQuery();
			data = getDataEntitiesFromResultSet(res.getClass());
			it = data.iterator();
			System.out.println("ifhavers========:" + it.hasNext());
			if (it.hasNext()) {
				res = (NatureInfo) it.next();
			}

		} catch (Exception e) {
			e.printStackTrace();
		}

		finalizeDAO();

		return res;
	}

}