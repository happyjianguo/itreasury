package com.iss.itreasury.ebank.obquery.bizlogic;

import com.iss.itreasury.ebank.obquery.dataentity.*;
import com.iss.itreasury.ebank.obquery.dao.*;
import java.util.*;
import com.iss.itreasury.ebank.util.*;
import com.iss.itreasury.ebank.approval.dataentity.InutParameterInfo;
import com.iss.itreasury.util.Constant;
import com.iss.itreasury.util.FSWorkflowManager;
import com.iss.itreasury.util.Log4j;
import com.iss.itreasury.util.OBFSWorkflowManager;

/**
 * Created 2002-12-7 19:29:33
 * Code generated by the Forte for Java EJB Module
 * @author Wang Yi
 */

public class OBCapitalTransQuery
{
	private static Log4j log4j = null;
	public OBCapitalTransQuery()
	{
	}
	public Collection query(OBQueryInfo qi) throws Exception
	{
		Collection cReturn = null;
		OBCapitalTransDao obCapitalTransDao = new OBCapitalTransDao();
		try
		{ 
			
			qi.setStatus(OBFSWorkflowManager.getOBCheckStatus(new InutParameterInfo(qi.getLofficeid(),
																		qi.getCurrencyID(),
																		qi.getClientID(),
																		Constant.ModuleType.SETTLEMENT,
																		qi.getTransType(),
																		qi.getRemitType()
																		)));
			 if (qi.getTransType() == OBConstant.QueryInstrType.CAPTRANSFER)
			{
				cReturn = obCapitalTransDao.queryMatchTrans(qi);
			}
			if (qi.getTransType() == OBConstant.QueryInstrType.CHILDCAPTRANSFER)
			{
				cReturn = obCapitalTransDao.queryMatchChildTrans(qi);
			}
			if (qi.getTransType() == OBConstant.QueryInstrType.FIXEDTOCURRENTTRANSFER)
			{
				cReturn = obCapitalTransDao.queryMatchFixedDraw(qi);
			}
			if (qi.getTransType() == OBConstant.QueryInstrType.OPENFIXDEPOSIT)
			{
				cReturn = obCapitalTransDao.queryMatchFixedOpen(qi);
			}
			if (qi.getTransType() == OBConstant.QueryInstrType.NOTIFYDEPOSITDRAW)
			{
				cReturn = obCapitalTransDao.queryMatchNoticeDraw(qi);
			}
			if (qi.getTransType() == OBConstant.QueryInstrType.OPENNOTIFYACCOUNT)
			{
				cReturn = obCapitalTransDao.queryMatchNoticeOpen(qi);
			}
			if (qi.getTransType() == OBConstant.QueryInstrType.TRUSTLOANRECEIVE 
			|| qi.getTransType() == OBConstant.QueryInstrType.YTLOANRECEIVE)
			{
				cReturn = obCapitalTransDao.queryMatchTrustLoan(qi);
			}
			if (qi.getTransType() == OBConstant.QueryInstrType.CONSIGNLOANRECEIVE)
			{
				cReturn = obCapitalTransDao.queryMatchConsignLoan(qi);
			}
			if (qi.getTransType() == OBConstant.QueryInstrType.INTERESTFEEPAYMENT)
			{
				cReturn = obCapitalTransDao.queryMatchInterest(qi);
			}
			if (qi.getTransType() == OBConstant.QueryInstrType.APPLYCAPITAL)
			{
				cReturn = obCapitalTransDao.queryMatchApplyCapital(qi);
			}
			if (qi.getTransType() == OBConstant.QueryInstrType.DRIVEFIXDEPOSIT)
			{
				cReturn = obCapitalTransDao.queryMatchDrivFixDeposit(qi);
			}
			if (qi.getTransType() == OBConstant.QueryInstrType.CHANGEFIXDEPOSIT)
			{
				cReturn = obCapitalTransDao.queryMatchChangeFixDdposit(qi);
			}
		}
		catch (Exception e)
		{
			log4j.error(e.toString());
			throw new Exception("Gen_E001");
		}
		return cReturn;
	}
}