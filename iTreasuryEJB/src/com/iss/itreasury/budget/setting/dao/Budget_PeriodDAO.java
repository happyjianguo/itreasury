/* Generated by Together */

package com.iss.itreasury.budget.setting.dao;

import com.iss.itreasury.budget.dao.BudgetDAO;
import com.iss.itreasury.budget.exception.BudgetException;
import com.iss.itreasury.dao.ITreasuryDAOException;
import com.iss.itreasury.util.Constant;
public class Budget_PeriodDAO extends BudgetDAO {
	public Budget_PeriodDAO(){
		super(" Budget_Period"); 
		super.setUseMaxID(); 
		}
	public long checkUse(long id) throws BudgetException
	{
		long lRtn = -1;

	    try {
            this.initDAO();
            String strSQL = "";
            strSQL += "select count(id) count from \n";           
            strSQL += "		BUDGET_PLAN \n";
            strSQL += "		where STATUSID != " + Constant.RecordStatus.INVALID + " and BUDGETPERIODID = "+ id + "\n";
           
        
            
                
            log.print(strSQL);
            transPS = transConn.prepareStatement(strSQL);
            transRS = transPS.executeQuery();
            while (transRS.next())
            {
                
                lRtn = transRS.getLong("count");
                
            }
        } catch (Exception e) {
            // TODO Auto-generated catch block
            e.printStackTrace();
            throw new BudgetException();
        }
        finally
        {
            try {
                this.finalizeDAO();
            } catch (ITreasuryDAOException e1) {
                // TODO Auto-generated catch block
                e1.printStackTrace();
            }
        }
	    
	
	
		return lRtn;
		
	}
 }